
/**
 * 数据库操作类
 * 单例模式
 */

var pg = require('pg');

//  var db = (function() {
export var db = (function() {
    var instance
    //提交执行sql
    function query( qstring ) {
        var conString = "postgres://silukou:silukou@localhost/silukou";
        var client = new pg.Client(conString);
        client.connect(); //就先连接上数据库,算为初始化
        client.query( qstring ,(err)=>{
            if(err){
                console.log( err )
            }
            client.end();
        })
    }
    //执行
    function init() {
        /*暴露方法列表*/
        return {
            query: query,
        };
    }
    return {
        getInstance: function(){
            if(!instance){
                instance = init()
            }
            return instance
        }
    }
})()
// var conString = "postgres://silukou:silukou@localhost/silukou";

// var client = new pg.Client(conString);
// client.connect(function(err) {
//     if(err) {
//         return console.error('could not connect to postgres', err);
//     }
// var qstr = "insert into stocklist( symbol, code, name, trade, pricechange, changepercent, buy, sell, settlement, open, high, low, volume, amount, ticktime, per,  per_d, nta,  pb,  mktcap,  nmc, turnoverratio, favor, guba ) \
// values('abaddfsef','300606','sdfsdf','46.600','0.570','1.238','46.590','46.600','46.030','45.800','46.860','45.510','7318832','338563846','15:55:03',77.667,0,'3.6300',12.837,415672,103918,32.81987,'','');"

//     client.query(qstr, function(err) {
//         if(err) {
//             return console.error('error running query', err);
//         }
//         //output: Tue Jan 15 2013 19:12:47 GMT-600 (CST)
//         client.end();
//     });
// });


// var obj = db.getInstance();

// // var qstr = "insert into stocklist( symbol, code, name, trade, pricechange, changepercent, buy, sell, settlement, open, high, low, volume, amount, ticktime, per,  per_d, nta,  pb,  mktcap,  nmc, turnoverratio, favor, guba ) \
// // values('c2277fsef','300606','sdfsdf','46.600','0.570','1.238','46.590','46.600','46.030','45.800','46.860','45.510','7318832','338563846','15:55:03',77.667,0,'3.6300',12.837,415672,103918,32.81987,'',''),('2a277fsef','300606','sdfsdf','46.600','0.570','1.238','46.590','46.600','46.030','45.800','46.860','45.510','7318832','338563846','15:55:03',77.667,0,'3.6300',12.837,415672,103918,32.81987,'',''),('22b77fsef','300606','sdfsdf','46.600','0.570','1.238','46.590','46.600','46.030','45.800','46.860','45.510','7318832','338563846','15:55:03',77.667,0,'3.6300',12.837,415672,103918,32.81987,'','')"

// var qstr = "insert into stocklist(symbol,code,name,trade,pricechange,changepercent,buy,sell,settlement,open,high,low,volume,                amount,ticktime,per,per_d,nta,pb,mktcap,nmc,turnoverratio,favor,guba) values ('sh600000','600000','浦发银行','16.290','0.050','0.308','16.280','16.290','16.240','16.270','16.350','16.250','19036545','310417986','15:00:00','6.113','6.131','15.2600','1.067','35216177.992938','33425155.429353','0.09278','',''),('sh600004','600004','白云机场','16.280','0.090','0.556','16.280','16.290','16.190','16.180','16.290','16.000','8374768','135308125','15:00:00','14.936','13.72','9.2473','1.761','1872304.952276','1872304.952276','0.7282','',''),('sh600006','600006','东风汽车','7.110','0.050','0.708','7.100','7.110','7.060','7.070','7.120','7.070','12454967','88372080','15:00:00','41.289','44.052','3.2570','2.183','1422000','1422000','0.62275','',''),('sh600007','600007','中国国贸','20.490','0.390','1.940','20.490','20.500','20.100','20.100','20.570','20.060','2466576','50204770','15:00:00','33.048','29.056','5.9539','3.441','2063921.912166','2063921.912166','0.24487','',''),('sh600008','600008','首创股份','4.360','-0.030','-0.683','4.370','4.380','4.390','4.380','4.420','4.360','50362320','220383761','15:00:00','19.456','19.587','1.9146','2.277','2101787.758064','2101787.758064','1.04473','',''),('sh600009','600009','上海机场','28.370','-0.330','-1.150','28.350','28.360','28.700','28.750','28.810','28.350','8452437','240934216','15:00:00','19.566','19.586','11.5637','2.453','5466781.116976','3102192.538289','0.77299','',''),('sh600010','600010','包钢股份','3.130','0.010','0.321','3.120','3.130','3.120','3.120','3.140','3.110','59005553','184223635','15:00:00','-24.301','-159.694','1.4542','2.152','10191510.870678','4927253.561454','0.37483','',''),('sh600011','600011','华能国际','7.710','-0.010','-0.130','7.710','7.720','7.720','7.720','7.760','7.680','10297794','79539283','15:00:00','8.116','11.793','5.4457','1.416','11719495.63224','8095500','0.09807','',''),('sh600012','600012','皖通高速','14.580','-0.010','-0.069','14.590','14.600','14.590','14.590','14.650','14.470','7403020','107824786','15:00:00','25.782','25.842','5.0899','2.864','2418253.38','1699444.8','0.63513','',''),('sh600015','600015','华夏银行','11.410','-0.010','-0.088','11.410','11.420','11.420','11.440','11.520','11.400','33582219','384839666','15:00:00','6.446','6.329','12.0100','0.95','12192237.892751','12192237.892751','0.31428','','')"
// obj.query( qstr )







// insert into stocklist(symbol,code,name,trade,pricechange,changepercent,buy,sell,settlement,open,high,low,volume,amount,ticktime,per,per_d,nta,pb,mktcap,nmc,turnoverratio,favor,guba) values 
// (sh600000,600000,浦发银行,16.290,0.050,0.308,16.280,16.290,16.240,16.270,16.350,16.250,19036545,310417986,15:00:00,6.113,6.131,15.2600,1.067,35216177.992938,33425155.429353,0.09278,,,),
// (sh600004,600004,白云机场,16.280,0.090,0.556,16.280,16.290,16.190,16.180,16.290,16.000,8374768,135308125,15:00:00,14.936,13.72,9.2473,1.761,1872304.952276,1872304.952276,0.7282,,,),
// (sh600006,600006,东风汽车,7.110,0.050,0.708,7.100,7.110,7.060,7.070,7.120,7.070,12454967,88372080,15:00:00,41.289,44.052,3.2570,2.183,1422000,1422000,0.62275,,,),
// (sh600007,600007,中国国贸,20.490,0.390,1.940,20.490,20.500,20.100,20.100,20.570,20.060,2466576,50204770,15:00:00,33.048,29.056,5.9539,3.441,2063921.912166,2063921.912166,0.24487,,,)


// insert into stocklist(symbol,code,name,trade,pricechange,changepercent,buy,sell,settlement,open,high,low,volume,                amount,ticktime,per,per_d,nta,pb,mktcap,nmc,turnoverratio,favor,guba) values ('sh600000','600000','浦发银行','16.290','0.050','0.308','16.280','16.290','16.240','16.270','16.350','16.250','19036545','310417986','15:00:00','6.113','6.131','15.2600','1.067','35216177.992938','33425155.429353','0.09278','','',),('sh600004','600004','白云机场','16.280','0.090','0.556','16.280','16.290','16.190','16.180','16.290','16.000','8374768','135308125','15:00:00','14.936','13.72','9.2473','1.761','1872304.952276','1872304.952276','0.7282','','',),('sh600006','600006','东风汽车','7.110','0.050','0.708','7.100','7.110','7.060','7.070','7.120','7.070','12454967','88372080','15:00:00','41.289','44.052','3.2570','2.183','1422000','1422000','0.62275','','',),('sh600007','600007','中国国贸','20.490','0.390','1.940','20.490','20.500','20.100','20.100','20.570','20.060','2466576','50204770','15:00:00','33.048','29.056','5.9539','3.441','2063921.912166','2063921.912166','0.24487','','',),('sh600008','600008','首创股份','4.360','-0.030','-0.683','4.370','4.380','4.390','4.380','4.420','4.360','50362320','220383761','15:00:00','19.456','19.587','1.9146','2.277','2101787.758064','2101787.758064','1.04473','','',),('sh600009','600009','上海机场','28.370','-0.330','-1.150','28.350','28.360','28.700','28.750','28.810','28.350','8452437','240934216','15:00:00','19.566','19.586','11.5637','2.453','5466781.116976','3102192.538289','0.77299','','',),('sh600010','600010','包钢股份','3.130','0.010','0.321','3.120','3.130','3.120','3.120','3.140','3.110','59005553','184223635','15:00:00','-24.301','-159.694','1.4542','2.152','10191510.870678','4927253.561454','0.37483','','',),('sh600011','600011','华能国际','7.710','-0.010','-0.130','7.710','7.720','7.720','7.720','7.760','7.680','10297794','79539283','15:00:00','8.116','11.793','5.4457','1.416','11719495.63224','8095500','0.09807','','',),('sh600012','600012','皖通高速','14.580','-0.010','-0.069','14.590','14.600','14.590','14.590','14.650','14.470','7403020','107824786','15:00:00','25.782','25.842','5.0899','2.864','2418253.38','1699444.8','0.63513','','',),('sh600015','600015','华夏银行','11.410','-0.010','-0.088','11.410','11.420','11.420','11.440','11.520','11.400','33582219','384839666','15:00:00','6.446','6.329','12.0100','0.95','12192237.892751','12192237.892751','0.31428','','',)


